# Manual GCE upgrade and clean install validation Xenial, Bionic, Cosmic
 
# To be adapted to the SRU to test
SRU_SERIES="xenial bionic disco eoan"
ZONE="us-central1-b"

cat > sethostname.yaml << EOF
## template: jinja
#cloud-config
ssh_import_id : [daniel-thewatkins]
hostname: SRU-worked-{{v1.cloud_name}}
EOF

cat > setup_proposed.sh <<EOF
#/bin/bash
mirror=http://archive.ubuntu.com/ubuntu
echo deb \$mirror \$(lsb_release -sc)-proposed main | tee /etc/apt/sources.list.d/proposed.list
apt-get update -q
apt-get install -qy cloud-init
EOF

sshopts=( -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o LogLevel=ERROR )


for release in $SRU_SERIES; do
  echo "### BEGIN $release"

  netcfg=/etc/netplan/50-cloud-init.yaml
  case $release in
      xenial) family=ubuntu-1604-lts
              netcfg=/etc/network/interfaces.d/50-cloud-init.cfg;;
      bionic) family=ubuntu-1804-lts;;
      cosmic) family=ubuntu-1810;;
      disco) family=ubuntu-1904;;
      eoan) family=ubuntu-1910;;
      *) echo "!! UPDATE FAMILY CASE STATEMENT !!"; exit 1;;
  esac

  gcloud compute instances create $release-sru-test --image-family $family --image-project ubuntu-os-cloud-devel --metadata-from-file user-data=sethostname.yaml --zone=$ZONE;
  VM_IP=$(gcloud compute instances list | grep $release-sru | awk '{printf "%s", $5}')

  while ! ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init status --wait --long; do
      sleep 5
  done

  # Capture current state
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- dpkg-query --show cloud-init
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- sudo cat /run/cloud-init/result.json
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- grep Trace /var/log/cloud-init.log
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- systemd-analyze
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- systemd-analyze blame
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init analyze show
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init analyze blame
  echo 'Networking config'
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cat $netcfg

  # Upgrade to -proposed cloud-init and reboot
  scp "${sshopts[@]}" setup_proposed.sh ubuntu@$VM_IP:.
  ssh "${sshopts[@]}" ubuntu@$VM_IP sudo bash ./setup_proposed.sh 2>&1 | egrep 'cloud-init'
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- dpkg-query --show cloud-init
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- sudo hostname SRU-didnt-work
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- sudo rm -f $netcfg
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- sudo cloud-init clean --logs --reboot
  ssh-keygen -f "/home/ubuntu/.ssh/known_hosts" -R $VM_IP

  sleep 10  # Wait for the instance to actually go down
  while ! ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init status --wait --long; do
      sleep 5
  done

  ssh "${sshopts[@]}" ubuntu@$VM_IP -- hostname
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- "grep Trace /var/log/cloud-init*"
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- systemd-analyze
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- systemd-analyze blame
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init analyze show
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init analyze blame
  echo 'After upgrade Networking config'
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cat $netcfg
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init query --format "'cloud-region: {{cloud_name}}-{{region}}'"
  echo "Get cloud-id"
  ssh "${sshopts[@]}" ubuntu@$VM_IP cloud-id

  echo 'Validating whether metadata is being updated per boot LP:1819913'
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- grep 'Update\ datasource' /var/log/cloud-init.log
  ssh "${sshopts[@]}" ubuntu@$VM_IP sudo reboot || true

  sleep 10
  while ! ssh "${sshopts[@]}" ubuntu@$VM_IP -- cloud-init status --wait --long; do
      sleep 5
  done

  echo 'After reboot'
  ssh "${sshopts[@]}" ubuntu@$VM_IP -- grep 'Update\ datasource' /var/log/cloud-init.log
done

for release in $SRU_SERIES; do
  gcloud compute instances delete --zone=$ZONE --quiet $release-sru-test
done


## Verification Output

### BEGIN xenial
Created [https://www.googleapis.com/compute/v1/projects/ubuntu-oddbloke/zones/us-central1-b/instances/xenial-sru-test].
NAME             ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS
xenial-sru-test  us-central1-b  n1-standard-1               10.240.0.79  35.225.142.85  RUNNING

status: done
time: Mon, 20 Jan 2020 20:01:09 +0000
detail:
DataSourceGCE
cloud-init	19.3-41-gc4735dd3-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-gce
{
 "v1": {
  "datasource": "DataSourceGCE",
  "errors": []
 }
}
Startup finished in 2.672s (kernel) + 31.694s (userspace) = 34.367s
         18.613s snapd.seeded.service
         10.146s pollinate.service
          3.349s open-iscsi.service
          2.857s mdadm.service
          2.733s grub-common.service
          2.714s accounts-daemon.service
          2.689s cloud-config.service
          2.433s apparmor.service
          2.166s lxd-containers.service
          2.093s cloud-init-local.service
          1.812s console-setup.service
          1.688s apport.service
          1.598s rc-local.service
          1.550s sshguard.service
          1.477s rsyslog.service
          1.377s systemd-logind.service
          1.361s ntp.service
          1.360s ondemand.service
          1.265s cloud-init.service
          1.149s dev-sda1.device
          1.005s plymouth-quit-wait.service
           687ms polkitd.service
           681ms google-instance-setup.service
           676ms snapd.service
           675ms plymouth-quit.service
           672ms google-shutdown-scripts.service
           539ms iscsid.service
           487ms cloud-final.service
           427ms lxd.socket
           405ms snapd.socket
           367ms networking.service
           360ms lvm2-monitor.service
           349ms systemd-user-sessions.service
           244ms google-startup-scripts.service
           163ms resolvconf.service
           156ms kmod-static-nodes.service
           151ms systemd-remount-fs.service
           142ms ufw.service
           141ms keyboard-setup.service
           134ms systemd-udev-trigger.service
           131ms systemd-journal-flush.service
           128ms dev-mqueue.mount
           128ms systemd-modules-load.service
           108ms systemd-sysctl.service
           102ms sys-kernel-debug.mount
            96ms systemd-machine-id-commit.service
            96ms systemd-tmpfiles-setup-dev.service
            88ms systemd-random-seed.service
            79ms sys-fs-fuse-connections.mount
            73ms dev-hugepages.mount
            71ms systemd-journald.service
            63ms systemd-tmpfiles-setup.service
            57ms systemd-update-utmp.service
            56ms systemd-udevd.service
            51ms sys-kernel-config.mount
            32ms ssh.service
            23ms user@1000.service
            16ms setvtrgb.service
            15ms plymouth-read-write.service
            14ms boot-efi.mount
            14ms systemd-update-utmp-runlevel.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.01400s +00.00000s
Finished stage: (init-local) 00.05500 seconds

Starting stage: init-network
|`->no cache found @01.22100s +00.00000s
|`->found network data from DataSourceGCE @01.22500s +00.07100s
|`->setting up datasource @01.36500s +00.00100s
|`->reading and applying user-data @01.37700s +00.00700s
|`->reading and applying vendor-data @01.38400s +00.00000s
|`->activating datasource @01.41400s +00.00100s
|`->config-migrator ran successfully @01.44100s +00.00000s
|`->config-seed_random ran successfully @01.44200s +00.00000s
|`->config-bootcmd ran successfully @01.44300s +00.00000s
|`->config-write-files ran successfully @01.44300s +00.00100s
|`->config-growpart ran successfully @01.44400s +00.12400s
|`->config-resizefs ran successfully @01.56900s +00.05200s
|`->config-disk_setup ran successfully @01.62200s +00.00100s
|`->config-mounts ran successfully @01.62300s +00.00100s
|`->config-set_hostname ran successfully @01.62500s +00.00500s
|`->config-update_hostname ran successfully @01.63000s +00.00100s
|`->config-update_etc_hosts ran successfully @01.63100s +00.00100s
|`->config-ca-certs ran successfully @01.63200s +00.00100s
|`->config-rsyslog ran successfully @01.63300s +00.00100s
|`->config-users-groups ran successfully @01.63400s +00.08600s
|`->config-ssh ran successfully @01.72000s +00.39100s
Finished stage: (init-network) 00.90600 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @25.03000s +00.00100s
|`->config-snap ran successfully @25.03100s +00.00100s
|`->config-snap_config ran successfully @25.03200s +00.00100s
|`->config-ssh-import-id ran successfully @25.03300s +00.88900s
|`->config-locale ran successfully @25.92200s +00.99500s
|`->config-set-passwords ran successfully @26.91700s +00.00100s
|`->config-grub-dpkg ran successfully @26.91800s +00.19800s
|`->config-apt-pipelining ran successfully @27.11600s +00.00200s
|`->config-apt-configure ran successfully @27.11800s +00.10200s
|`->config-ubuntu-advantage ran successfully @27.22100s +00.00000s
|`->config-ntp ran successfully @27.22200s +00.00000s
|`->config-timezone ran successfully @27.22300s +00.00000s
|`->config-disable-ec2-metadata ran successfully @27.22300s +00.00100s
|`->config-runcmd ran successfully @27.22400s +00.00000s
|`->config-byobu ran successfully @27.22500s +00.00000s
Finished stage: (modules-config) 02.22500 seconds

Starting stage: modules-final
|`->config-snappy ran successfully @27.65900s +00.00100s
|`->config-package-update-upgrade-install ran successfully @27.66100s +00.00100s
|`->config-fan ran successfully @27.66200s +00.00100s
|`->config-landscape ran successfully @27.66300s +00.00100s
|`->config-lxd ran successfully @27.66400s +00.00100s
|`->config-ubuntu-drivers ran successfully @27.66500s +00.00100s
|`->config-puppet ran successfully @27.66600s +00.00100s
|`->config-chef ran successfully @27.66700s +00.00100s
|`->config-mcollective ran successfully @27.66800s +00.00100s
|`->config-salt-minion ran successfully @27.66900s +00.00000s
|`->config-rightscale_userdata ran successfully @27.67000s +00.00000s
|`->config-scripts-vendor ran successfully @27.67000s +00.00100s
|`->config-scripts-per-once ran successfully @27.67100s +00.00100s
|`->config-scripts-per-boot ran successfully @27.67200s +00.00000s
|`->config-scripts-per-instance ran successfully @27.67300s +00.00000s
|`->config-scripts-user ran successfully @27.67300s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @27.67400s +00.00300s
|`->config-keys-to-console ran successfully @27.67700s +00.02300s
|`->config-phone-home ran successfully @27.70100s +00.00100s
|`->config-final-message ran successfully @27.70200s +00.00700s
|`->config-power-state-change ran successfully @27.70900s +00.00100s
Finished stage: (modules-final) 00.08400 seconds

Total Time: 3.27000 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.99500s (modules-config/config-locale)
     00.88900s (modules-config/config-ssh-import-id)
     00.39100s (init-network/config-ssh)
     00.19800s (modules-config/config-grub-dpkg)
     00.12400s (init-network/config-growpart)
     00.10200s (modules-config/config-apt-configure)
     00.08600s (init-network/config-users-groups)
     00.07100s (init-network/search-GCE)
     00.05200s (init-network/config-resizefs)
     00.02300s (modules-final/config-keys-to-console)
     00.00700s (modules-final/config-final-message)
     00.00700s (init-network/consume-user-data)
     00.00500s (init-network/config-set_hostname)
     00.00300s (modules-final/config-ssh-authkey-fingerprints)
     00.00200s (modules-config/config-apt-pipelining)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-snappy)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (init-network/setup-datasource)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-disk_setup)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-network/activate-datasource)
     00.00000s (modules-final/config-scripts-per-instance)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-rightscale_userdata)
     00.00000s (modules-config/config-ubuntu-advantage)
     00.00000s (modules-config/config-timezone)
     00.00000s (modules-config/config-runcmd)
     00.00000s (modules-config/config-ntp)
     00.00000s (modules-config/config-byobu)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-seed_random)
     00.00000s (init-network/config-migrator)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-network/check-cache)
     00.00000s (init-local/check-cache)

1 boot records analyzed
Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto ens4
iface ens4 inet dhcp
setup_proposed.sh                                                                                                                                                                100%  194     4.2KB/s   00:00    
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu xenial-proposed/main amd64 cloud-init all 19.4-33-gbb4131a2-0ubuntu1~16.04.1 [413 kB]
Preparing to unpack .../cloud-init_19.4-33-gbb4131a2-0ubuntu1~16.04.1_all.deb ...
Unpacking cloud-init (19.4-33-gbb4131a2-0ubuntu1~16.04.1) over (19.3-41-gc4735dd3-0ubuntu1~16.04.1) ...
Setting up cloud-init (19.4-33-gbb4131a2-0ubuntu1~16.04.1) ...
Leaving 'diversion of /etc/init/ureadahead.conf to /etc/init/ureadahead.conf.disabled by cloud-init'
cloud-init	19.4-33-gbb4131a2-0ubuntu1~16.04.1
sudo: unable to resolve host SRU-worked-gce
sudo: unable to resolve host SRU-didnt-work
sudo: unable to resolve host SRU-didnt-work
Connection to 35.225.142.85 closed by remote host.
mkstemp: No such file or directory
ssh: connect to host 35.225.142.85 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:02:31 +0000
detail:
DataSourceGCE
SRU-worked-gce
Startup finished in 2.729s (kernel) + 14.321s (userspace) = 17.051s
          2.581s accounts-daemon.service
          2.414s open-iscsi.service
          2.210s cloud-final.service
          2.032s cloud-config.service
          1.694s apport.service
          1.618s systemd-logind.service
          1.604s grub-common.service
          1.543s mdadm.service
          1.453s dev-sda1.device
          1.434s cloud-init-local.service
          1.432s lxd-containers.service
          1.349s polkitd.service
          1.011s setvtrgb.service
          1.011s ondemand.service
          1.006s ntp.service
           982ms pollinate.service
           875ms cloud-init.service
           801ms snapd.service
           686ms ssh.service
           680ms google-instance-setup.service
           666ms plymouth-quit.service
           530ms iscsid.service
           499ms lxd.socket
           412ms rsyslog.service
           395ms resolvconf.service
           380ms lvm2-monitor.service
           369ms google-startup-scripts.service
           349ms google-shutdown-scripts.service
           348ms networking.service
           341ms snapd.seeded.service
           336ms systemd-user-sessions.service
           328ms systemd-remount-fs.service
           316ms apparmor.service
           265ms kmod-static-nodes.service
           248ms dev-hugepages.mount
           237ms systemd-modules-load.service
           219ms keyboard-setup.service
           219ms dev-mqueue.mount
           208ms console-setup.service
           176ms rc-local.service
           174ms systemd-udev-trigger.service
           172ms sys-kernel-debug.mount
           159ms sshguard.service
           148ms systemd-sysctl.service
           144ms systemd-journal-flush.service
           143ms ufw.service
           131ms systemd-random-seed.service
           131ms systemd-tmpfiles-setup-dev.service
           111ms sys-kernel-config.mount
            95ms sys-fs-fuse-connections.mount
            91ms snapd.socket
            79ms systemd-tmpfiles-setup.service
            75ms systemd-journald.service
            55ms systemd-udevd.service
            32ms plymouth-read-write.service
            22ms user@1000.service
            22ms systemd-update-utmp.service
            17ms plymouth-quit-wait.service
            13ms boot-efi.mount
            13ms systemd-update-utmp-runlevel.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00500s +00.00000s
Finished stage: (init-local) 00.06900 seconds

Starting stage: init-network
|`->no cache found @00.85400s +00.00000s
|`->found network data from DataSourceGCE @00.85800s +00.04800s
|`->setting up datasource @00.97900s +00.00000s
|`->reading and applying user-data @00.99100s +00.00800s
|`->reading and applying vendor-data @00.99900s +00.00000s
|`->activating datasource @01.02700s +00.00200s
|`->config-migrator ran successfully @01.05900s +00.00100s
|`->config-seed_random ran successfully @01.06000s +00.00100s
|`->config-bootcmd ran successfully @01.06100s +00.00000s
|`->config-write-files ran successfully @01.06200s +00.00000s
|`->config-growpart ran successfully @01.06200s +00.06600s
|`->config-resizefs ran successfully @01.12900s +00.02500s
|`->config-disk_setup ran successfully @01.15500s +00.00200s
|`->config-mounts ran successfully @01.15800s +00.00100s
|`->config-set_hostname ran successfully @01.15900s +00.00500s
|`->config-update_hostname ran successfully @01.16500s +00.00100s
|`->config-update_etc_hosts ran successfully @01.16600s +00.00000s
|`->config-ca-certs ran successfully @01.16700s +00.00000s
|`->config-rsyslog ran successfully @01.16800s +00.00000s
|`->config-users-groups ran successfully @01.16900s +00.03500s
|`->config-ssh ran successfully @01.20400s +00.13900s
Finished stage: (init-network) 00.50700 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @06.39700s +00.00200s
|`->config-snap ran successfully @06.39900s +00.00600s
|`->config-ssh-import-id ran successfully @06.40600s +00.43000s
|`->config-locale ran successfully @06.83700s +00.00100s
|`->config-set-passwords ran successfully @06.83900s +00.00000s
|`->config-grub-dpkg ran successfully @06.84000s +00.36600s
|`->config-apt-pipelining ran successfully @07.20600s +00.00100s
|`->config-apt-configure ran successfully @07.20800s +00.11200s
|`->config-ubuntu-advantage ran successfully @07.32000s +00.00100s
|`->config-ntp ran successfully @07.32100s +00.00100s
|`->config-timezone ran successfully @07.32200s +00.00100s
|`->config-disable-ec2-metadata ran successfully @07.32300s +00.00000s
|`->config-runcmd ran successfully @07.32400s +00.00100s
|`->config-byobu ran successfully @07.32500s +00.00100s
Finished stage: (modules-config) 00.98800 seconds

Starting stage: modules-final
|`->config-package-update-upgrade-install ran successfully @08.51900s +00.00000s
|`->config-fan ran successfully @08.52000s +00.00100s
|`->config-landscape ran successfully @08.52100s +00.00100s
|`->config-lxd ran successfully @08.52200s +00.00000s
|`->config-ubuntu-drivers ran successfully @08.52300s +00.00000s
|`->config-puppet ran successfully @08.52400s +00.00000s
|`->config-chef ran successfully @08.52500s +00.00000s
|`->config-mcollective ran successfully @08.52500s +00.00100s
|`->config-salt-minion ran successfully @08.52600s +00.00100s
|`->config-rightscale_userdata ran successfully @08.52700s +00.00100s
|`->config-scripts-vendor ran successfully @08.52800s +00.00100s
|`->config-scripts-per-once ran successfully @08.52900s +00.00100s
|`->config-scripts-per-boot ran successfully @08.53000s +00.00000s
|`->config-scripts-per-instance ran successfully @08.53000s +00.00100s
|`->config-scripts-user ran successfully @08.53100s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @08.53200s +01.24500s
|`->config-keys-to-console ran successfully @09.77700s +00.33900s
|`->config-phone-home ran successfully @10.14200s +00.00100s
|`->config-final-message ran successfully @10.14300s +00.03300s
|`->config-power-state-change ran successfully @10.17600s +00.00100s
Finished stage: (modules-final) 01.69400 seconds

Total Time: 3.25800 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.24500s (modules-final/config-ssh-authkey-fingerprints)
     00.43000s (modules-config/config-ssh-import-id)
     00.36600s (modules-config/config-grub-dpkg)
     00.33900s (modules-final/config-keys-to-console)
     00.13900s (init-network/config-ssh)
     00.11200s (modules-config/config-apt-configure)
     00.06600s (init-network/config-growpart)
     00.04800s (init-network/search-GCE)
     00.03500s (init-network/config-users-groups)
     00.03300s (modules-final/config-final-message)
     00.02500s (init-network/config-resizefs)
     00.00800s (init-network/consume-user-data)
     00.00600s (modules-config/config-snap)
     00.00500s (init-network/config-set_hostname)
     00.00200s (modules-config/config-emit_upstart)
     00.00200s (init-network/config-disk_setup)
     00.00200s (init-network/activate-datasource)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-salt-minion)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-ntp)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-migrator)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-package-update-upgrade-install)
     00.00000s (modules-final/config-lxd)
     00.00000s (modules-final/config-chef)
     00.00000s (modules-config/config-set-passwords)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/setup-datasource)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-rsyslog)
     00.00000s (init-network/config-ca-certs)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-network/check-cache)
     00.00000s (init-local/check-cache)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
auto lo
iface lo inet loopback

auto ens4
iface ens4 inet dhcp
cloud-region: gce-us-central1
Get cloud-id
gce
Validating whether metadata is being updated per boot LP:1819913
2020-01-20 20:02:22,478 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
sudo: unable to resolve host SRU-worked-gce
Connection to 35.225.142.85 closed by remote host.
ssh: connect to host 35.225.142.85 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:03:11 +0000
detail:
DataSourceGCE
After reboot
2020-01-20 20:02:22,478 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2020-01-20 20:03:05,223 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
### BEGIN bionic
Created [https://www.googleapis.com/compute/v1/projects/ubuntu-oddbloke/zones/us-central1-b/instances/bionic-sru-test].
NAME             ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS
bionic-sru-test  us-central1-b  n1-standard-1               10.240.0.80  34.67.150.239  RUNNING

status: done
time: Mon, 20 Jan 2020 20:04:32 +0000
detail:
DataSourceGCE
cloud-init	19.3-41-gc4735dd3-0ubuntu1~18.04.1
{
 "v1": {
  "datasource": "DataSourceGCE",
  "errors": []
 }
}
Startup finished in 3.854s (kernel) + 43.135s (userspace) = 46.989s
graphical.target reached after 40.106s in userspace
         27.934s snapd.seeded.service
         10.584s pollinate.service
          4.076s accounts-daemon.service
          2.365s apport.service
          2.285s grub-common.service
          1.992s cloud-config.service
          1.752s cloud-init.service
          1.716s systemd-user-sessions.service
          1.653s systemd-logind.service
          1.637s cloud-init-local.service
          1.571s dev-sda1.device
          1.503s sshguard.service
          1.205s systemd-networkd-wait-online.service
          1.133s snapd.service
          1.103s polkit.service
          1.059s lxd-containers.service
          1.055s apparmor.service
          1.043s google-instance-setup.service
          1.039s networkd-dispatcher.service
           831ms rsyslog.service
           718ms plymouth-quit.service
           703ms cloud-final.service
           683ms setvtrgb.service
           452ms ufw.service
           451ms sys-kernel-debug.mount
           436ms lvm2-monitor.service
           431ms keyboard-setup.service
           390ms lxd.socket
           373ms plymouth-quit-wait.service
           338ms google-shutdown-scripts.service
           323ms google-startup-scripts.service
           304ms systemd-modules-load.service
           283ms systemd-udev-trigger.service
           283ms dev-mqueue.mount
           228ms systemd-remount-fs.service
           199ms snapd.socket
           183ms kmod-static-nodes.service
           160ms systemd-journal-flush.service
           139ms ebtables.service
           134ms dev-hugepages.mount
           115ms systemd-tmpfiles-setup-dev.service
           115ms systemd-sysctl.service
           115ms sys-fs-fuse-connections.mount
           115ms sys-kernel-config.mount
           114ms systemd-random-seed.service
           110ms systemd-networkd.service
            96ms systemd-tmpfiles-setup.service
            95ms console-setup.service
            95ms systemd-machine-id-commit.service
            95ms plymouth-read-write.service
            76ms systemd-udevd.service
            66ms chrony.service
            63ms blk-availability.service
            55ms systemd-resolved.service
            48ms systemd-journald.service
            40ms user@1000.service
            33ms dev-loop1.device
            33ms ssh.service
            32ms dev-loop0.device
            27ms snap-core-8268.mount
            25ms snap-google\x2dcloud\x2dsdk-113.mount
            25ms systemd-update-utmp.service
            21ms systemd-update-utmp-runlevel.service
            14ms boot-efi.mount
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00100s
Finished stage: (init-local) 00.22500 seconds

Starting stage: init-network
|`->no cache found @02.15100s +00.00000s
|`->found network data from DataSourceGCE @02.17600s +00.07700s
|`->setting up datasource @02.44400s +00.00000s
|`->reading and applying user-data @02.46100s +00.00900s
|`->reading and applying vendor-data @02.47100s +00.00000s
|`->activating datasource @02.49700s +00.00200s
|`->config-migrator ran successfully @02.53100s +00.00100s
|`->config-seed_random ran successfully @02.53200s +00.00100s
|`->config-bootcmd ran successfully @02.53300s +00.00100s
|`->config-write-files ran successfully @02.53400s +00.00000s
|`->config-growpart ran successfully @02.53500s +00.20400s
|`->config-resizefs ran successfully @02.74000s +00.25100s
|`->config-disk_setup ran successfully @02.99200s +00.00100s
|`->config-mounts ran successfully @02.99400s +00.00100s
|`->config-set_hostname ran successfully @02.99500s +00.00600s
|`->config-update_hostname ran successfully @03.00200s +00.00100s
|`->config-update_etc_hosts ran successfully @03.00300s +00.00000s
|`->config-ca-certs ran successfully @03.00400s +00.00000s
|`->config-rsyslog ran successfully @03.00500s +00.00000s
|`->config-users-groups ran successfully @03.00500s +00.11300s
|`->config-ssh ran successfully @03.11800s +00.22900s
Finished stage: (init-network) 01.21400 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @35.87900s +00.00000s
|`->config-snap ran successfully @35.87900s +00.00100s
|`->config-snap_config ran successfully @35.88000s +00.00100s
|`->config-ssh-import-id ran successfully @35.88100s +00.76900s
|`->config-locale ran successfully @36.65000s +00.00200s
|`->config-set-passwords ran successfully @36.65200s +00.00100s
|`->config-grub-dpkg ran successfully @36.65300s +00.29500s
|`->config-apt-pipelining ran successfully @36.94900s +00.00100s
|`->config-apt-configure ran successfully @36.95000s +00.11100s
|`->config-ubuntu-advantage ran successfully @37.06200s +00.00000s
|`->config-ntp ran successfully @37.06300s +00.08900s
|`->config-timezone ran successfully @37.15300s +00.00100s
|`->config-disable-ec2-metadata ran successfully @37.15400s +00.00000s
|`->config-runcmd ran successfully @37.15400s +00.00100s
|`->config-byobu ran successfully @37.15500s +00.00100s
Finished stage: (modules-config) 01.30900 seconds

Starting stage: modules-final
|`->config-snappy ran successfully @37.83300s +00.00100s
|`->config-package-update-upgrade-install ran successfully @37.83500s +00.00000s
|`->config-fan ran successfully @37.83600s +00.00000s
|`->config-landscape ran successfully @37.83600s +00.00100s
|`->config-lxd ran successfully @37.83700s +00.00100s
|`->config-ubuntu-drivers ran successfully @37.83800s +00.00000s
|`->config-puppet ran successfully @37.83900s +00.00000s
|`->config-chef ran successfully @37.83900s +00.00100s
|`->config-mcollective ran successfully @37.84000s +00.00100s
|`->config-salt-minion ran successfully @37.84100s +00.00000s
|`->config-rightscale_userdata ran successfully @37.84200s +00.00000s
|`->config-scripts-vendor ran successfully @37.84300s +00.00000s
|`->config-scripts-per-once ran successfully @37.84300s +00.00100s
|`->config-scripts-per-boot ran successfully @37.84400s +00.00000s
|`->config-scripts-per-instance ran successfully @37.84500s +00.00000s
|`->config-scripts-user ran successfully @37.84500s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @37.84600s +00.00300s
|`->config-keys-to-console ran successfully @37.84900s +00.03100s
|`->config-phone-home ran successfully @37.88100s +00.00100s
|`->config-final-message ran successfully @37.88200s +00.00600s
|`->config-power-state-change ran successfully @37.88800s +00.00100s
Finished stage: (modules-final) 00.09200 seconds

Total Time: 2.84000 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.76900s (modules-config/config-ssh-import-id)
     00.29500s (modules-config/config-grub-dpkg)
     00.25100s (init-network/config-resizefs)
     00.22900s (init-network/config-ssh)
     00.20400s (init-network/config-growpart)
     00.11300s (init-network/config-users-groups)
     00.11100s (modules-config/config-apt-configure)
     00.08900s (modules-config/config-ntp)
     00.07700s (init-network/search-GCE)
     00.03100s (modules-final/config-keys-to-console)
     00.00900s (init-network/consume-user-data)
     00.00600s (modules-final/config-final-message)
     00.00600s (init-network/config-set_hostname)
     00.00300s (modules-final/config-ssh-authkey-fingerprints)
     00.00200s (modules-config/config-locale)
     00.00200s (init-network/activate-datasource)
     00.00100s (modules-final/config-snappy)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-disk_setup)
     00.00100s (init-network/config-bootcmd)
     00.00100s (init-local/check-cache)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-vendor)
     00.00000s (modules-final/config-scripts-per-instance)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-rightscale_userdata)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-package-update-upgrade-install)
     00.00000s (modules-final/config-fan)
     00.00000s (modules-config/config-ubuntu-advantage)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/setup-datasource)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-rsyslog)
     00.00000s (init-network/config-ca-certs)
     00.00000s (init-network/check-cache)

1 boot records analyzed
Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:50
            set-name: ens4
    version: 2
setup_proposed.sh                                                                                                                                                                100%  194     3.8KB/s   00:00    
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu bionic-proposed/main amd64 cloud-init all 19.4-33-gbb4131a2-0ubuntu1~18.04.1 [409 kB]
Preparing to unpack .../cloud-init_19.4-33-gbb4131a2-0ubuntu1~18.04.1_all.deb ...
Unpacking cloud-init (19.4-33-gbb4131a2-0ubuntu1~18.04.1) over (19.3-41-gc4735dd3-0ubuntu1~18.04.1) ...
Setting up cloud-init (19.4-33-gbb4131a2-0ubuntu1~18.04.1) ...
cloud-init	19.4-33-gbb4131a2-0ubuntu1~18.04.1
Connection to 34.67.150.239 closed by remote host.
mkstemp: No such file or directory
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:05:55 +0000
detail:
DataSourceGCE
SRU-worked-gce
Startup finished in 3.792s (kernel) + 18.545s (userspace) = 22.338s
graphical.target reached after 13.785s in userspace
          3.671s snapd.service
          2.497s pollinate.service
          2.223s cloud-config.service
          2.154s dev-sda1.device
          1.968s cloud-final.service
          1.781s cloud-init-local.service
          1.757s systemd-networkd-wait-online.service
          1.659s networkd-dispatcher.service
          1.571s accounts-daemon.service
          1.401s lxd-containers.service
          1.364s cloud-init.service
          1.031s google-instance-setup.service
           984ms rsyslog.service
           869ms polkit.service
           697ms grub-common.service
           666ms systemd-logind.service
           568ms apparmor.service
           559ms google-startup-scripts.service
           385ms dev-loop0.device
           384ms dev-loop1.device
           369ms ssh.service
           363ms apport.service
           352ms systemd-journal-flush.service
           342ms snapd.seeded.service
           316ms lvm2-monitor.service
           295ms systemd-udev-trigger.service
           263ms systemd-hostnamed.service
           254ms snapd.socket
           246ms lxd.socket
           230ms sshguard.service
           214ms keyboard-setup.service
           191ms systemd-remount-fs.service
           189ms systemd-modules-load.service
           188ms ufw.service
           187ms dev-mqueue.mount
           182ms kmod-static-nodes.service
           168ms dev-hugepages.mount
           167ms sys-kernel-debug.mount
           159ms ebtables.service
           129ms systemd-user-sessions.service
           118ms systemd-journald.service
           115ms systemd-sysctl.service
           115ms sys-fs-fuse-connections.mount
           115ms sys-kernel-config.mount
           114ms systemd-random-seed.service
           109ms systemd-udevd.service
           106ms systemd-networkd.service
            99ms systemd-tmpfiles-setup-dev.service
            79ms blk-availability.service
            58ms systemd-resolved.service
            54ms chrony.service
            47ms console-setup.service
            47ms systemd-tmpfiles-setup.service
            47ms plymouth-read-write.service
            40ms user@1000.service
            32ms snap-core-8268.mount
            30ms snap-google\x2dcloud\x2dsdk-113.mount
            28ms setvtrgb.service
            27ms systemd-update-utmp.service
            15ms plymouth-quit.service
            14ms systemd-update-utmp-runlevel.service
            14ms boot-efi.mount
             9ms plymouth-quit-wait.service
             7ms google-shutdown-scripts.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00300s +00.00100s
Finished stage: (init-local) 00.22500 seconds

Starting stage: init-network
|`->no cache found @02.67100s +00.00000s
|`->found network data from DataSourceGCE @02.69200s +00.05000s
|`->setting up datasource @02.92500s +00.00000s
|`->reading and applying user-data @02.94000s +00.00800s
|`->reading and applying vendor-data @02.94800s +00.00000s
|`->activating datasource @02.97300s +00.00100s
|`->config-migrator ran successfully @02.99500s +00.00100s
|`->config-seed_random ran successfully @02.99600s +00.00100s
|`->config-bootcmd ran successfully @02.99700s +00.00000s
|`->config-write-files ran successfully @02.99800s +00.00000s
|`->config-growpart ran successfully @02.99800s +00.08300s
|`->config-resizefs ran successfully @03.08100s +00.04600s
|`->config-disk_setup ran successfully @03.12700s +00.00200s
|`->config-mounts ran successfully @03.12900s +00.00400s
|`->config-set_hostname ran successfully @03.13300s +00.00800s
|`->config-update_hostname ran successfully @03.14100s +00.00100s
|`->config-update_etc_hosts ran successfully @03.14200s +00.00000s
|`->config-ca-certs ran successfully @03.14300s +00.00000s
|`->config-rsyslog ran successfully @03.14300s +00.00100s
|`->config-users-groups ran successfully @03.14500s +00.08800s
|`->config-ssh ran successfully @03.23300s +00.27700s
Finished stage: (init-network) 00.85700 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @09.02700s +00.00100s
|`->config-snap ran successfully @09.02800s +00.00100s
|`->config-ssh-import-id ran successfully @09.02900s +00.79000s
|`->config-locale ran successfully @09.81900s +00.00200s
|`->config-set-passwords ran successfully @09.82100s +00.00100s
|`->config-grub-dpkg ran successfully @09.82200s +00.51600s
|`->config-apt-pipelining ran successfully @10.33800s +00.00100s
|`->config-apt-configure ran successfully @10.34000s +00.11000s
|`->config-ubuntu-advantage ran successfully @10.45000s +00.00100s
|`->config-ntp ran successfully @10.45200s +00.07600s
|`->config-timezone ran successfully @10.52900s +00.00100s
|`->config-disable-ec2-metadata ran successfully @10.53400s +00.00000s
|`->config-runcmd ran successfully @10.53500s +00.00000s
|`->config-byobu ran successfully @10.53600s +00.00000s
Finished stage: (modules-config) 01.53600 seconds

Starting stage: modules-final
|`->config-package-update-upgrade-install ran successfully @11.33800s +00.00100s
|`->config-fan ran successfully @11.33900s +00.00100s
|`->config-landscape ran successfully @11.34000s +00.00000s
|`->config-lxd ran successfully @11.34100s +00.00000s
|`->config-ubuntu-drivers ran successfully @11.34200s +00.00000s
|`->config-puppet ran successfully @11.34200s +00.00100s
|`->config-chef ran successfully @11.34300s +00.00100s
|`->config-mcollective ran successfully @11.34400s +00.00100s
|`->config-salt-minion ran successfully @11.34500s +00.00000s
|`->config-rightscale_userdata ran successfully @11.34600s +00.00000s
|`->config-scripts-vendor ran successfully @11.34600s +00.00100s
|`->config-scripts-per-once ran successfully @11.34700s +00.00100s
|`->config-scripts-per-boot ran successfully @11.34800s +00.00000s
|`->config-scripts-per-instance ran successfully @11.34800s +00.00100s
|`->config-scripts-user ran successfully @11.34900s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @11.35000s +01.03000s
|`->config-keys-to-console ran successfully @12.38000s +00.07100s
|`->config-phone-home ran successfully @12.45100s +00.00100s
|`->config-final-message ran successfully @12.45300s +00.01300s
|`->config-power-state-change ran successfully @12.46700s +00.00000s
Finished stage: (modules-final) 01.27300 seconds

Total Time: 3.89100 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.03000s (modules-final/config-ssh-authkey-fingerprints)
     00.79000s (modules-config/config-ssh-import-id)
     00.51600s (modules-config/config-grub-dpkg)
     00.27700s (init-network/config-ssh)
     00.11000s (modules-config/config-apt-configure)
     00.08800s (init-network/config-users-groups)
     00.08300s (init-network/config-growpart)
     00.07600s (modules-config/config-ntp)
     00.07100s (modules-final/config-keys-to-console)
     00.05000s (init-network/search-GCE)
     00.04600s (init-network/config-resizefs)
     00.01300s (modules-final/config-final-message)
     00.00800s (init-network/consume-user-data)
     00.00800s (init-network/config-set_hostname)
     00.00400s (init-network/config-mounts)
     00.00200s (modules-config/config-locale)
     00.00200s (init-network/config-disk_setup)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-puppet)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-emit_upstart)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/activate-datasource)
     00.00100s (init-local/check-cache)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-rightscale_userdata)
     00.00000s (modules-final/config-power-state-change)
     00.00000s (modules-final/config-lxd)
     00.00000s (modules-final/config-landscape)
     00.00000s (modules-config/config-runcmd)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (modules-config/config-byobu)
     00.00000s (init-network/setup-datasource)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-ca-certs)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-network/check-cache)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:50
            set-name: ens4
    version: 2
cloud-region: gce-us-central1
Get cloud-id
gce
Validating whether metadata is being updated per boot LP:1819913
2020-01-20 20:05:45,959 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
Connection to 34.67.150.239 closed by remote host.
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused
ssh: connect to host 34.67.150.239 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:08:15 +0000
detail:
DataSourceGCE
After reboot
2020-01-20 20:05:45,959 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2020-01-20 20:08:08,363 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
### BEGIN disco
Created [https://www.googleapis.com/compute/v1/projects/ubuntu-oddbloke/zones/us-central1-b/instances/disco-sru-test].
NAME            ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS
disco-sru-test  us-central1-b  n1-standard-1               10.240.0.81  35.238.11.239  RUNNING

status: done
time: Mon, 20 Jan 2020 20:09:41 +0000
detail:
DataSourceGCE
cloud-init	19.3-41-gc4735dd3-0ubuntu1~19.04.1
{
 "v1": {
  "datasource": "DataSourceGCE",
  "errors": []
 }
}
Startup finished in 1.137s (kernel) + 1min 2.812s (userspace) = 1min 3.950s 
graphical.target reached after 1min 64ms in userspace
         49.078s snapd.seeded.service
         10.717s pollinate.service
          1.959s systemd-networkd-wait-online.service
          1.880s cloud-config.service
          1.860s cloud-init.service
          1.589s dev-sda1.device
          1.452s lvm2-monitor.service
          1.341s cloud-init-local.service
          1.168s systemd-udev-settle.service
          1.031s snapd.service
           955ms systemd-logind.service
           885ms google-instance-setup.service
           856ms networkd-dispatcher.service
           725ms apparmor.service
           650ms systemd-journald.service
           537ms cloud-final.service
           490ms blk-availability.service
           487ms atd.service
           456ms accounts-daemon.service
           427ms snap.lxd.activate.service
           425ms apport.service
           344ms systemd-networkd.service
           332ms systemd-resolved.service
           319ms google-startup-scripts.service
           295ms grub-common.service
           287ms keyboard-setup.service
           271ms snapd.socket
           251ms rsyslog.service
           245ms systemd-udev-trigger.service
           211ms dev-hugepages.mount
           210ms systemd-user-sessions.service
           161ms systemd-modules-load.service
           126ms systemd-sysusers.service
           111ms user@1000.service
            96ms sshguard.service
            91ms ufw.service
            91ms sys-kernel-debug.mount
            91ms systemd-sysctl.service
            90ms dev-mqueue.mount
            85ms grub-initrd-fallback.service
            84ms kmod-static-nodes.service
            73ms systemd-tmpfiles-setup.service
            70ms systemd-udevd.service
            70ms systemd-machine-id-commit.service
            64ms console-setup.service
            64ms systemd-remount-fs.service
            63ms chrony.service
            62ms plymouth-read-write.service
            60ms finalrd.service
            58ms multipathd.service
            40ms sys-kernel-config.mount
            39ms snap-google\x2dcloud\x2dsdk-113.mount
            39ms dev-loop1.device
            35ms sys-fs-fuse-connections.mount
            34ms snap-core-8268.mount
            31ms ssh.service
            30ms dev-loop2.device
            29ms systemd-journal-flush.service
            29ms systemd-tmpfiles-setup-dev.service
            27ms snap-lxd-12631.mount
            25ms plymouth-quit-wait.service
            24ms plymouth-quit.service
            22ms user-runtime-dir@1000.service
            18ms systemd-update-utmp-runlevel.service
            17ms dev-loop0.device
            15ms setvtrgb.service
            15ms boot-efi.mount
            12ms systemd-update-utmp.service
            11ms systemd-random-seed.service
             6ms google-shutdown-scripts.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00100s
Finished stage: (init-local) 00.19600 seconds

Starting stage: init-network
|`->no cache found @02.98200s +00.00000s
|`->found network data from DataSourceGCE @02.98600s +00.06800s
|`->setting up datasource @03.21200s +00.00000s
|`->reading and applying user-data @03.22700s +00.00700s
|`->reading and applying vendor-data @03.23400s +00.00000s
|`->activating datasource @03.25800s +00.00100s
|`->config-migrator ran successfully @03.29800s +00.00100s
|`->config-seed_random ran successfully @03.29900s +00.00100s
|`->config-bootcmd ran successfully @03.30000s +00.00000s
|`->config-write-files ran successfully @03.30000s +00.00100s
|`->config-growpart ran successfully @03.30100s +00.43200s
|`->config-resizefs ran successfully @03.73400s +00.20700s
|`->config-disk_setup ran successfully @03.94100s +00.00100s
|`->config-mounts ran successfully @03.94200s +00.00200s
|`->config-set_hostname ran successfully @03.94400s +00.00500s
|`->config-update_hostname ran successfully @03.94900s +00.00100s
|`->config-update_etc_hosts ran successfully @03.95000s +00.00000s
|`->config-ca-certs ran successfully @03.95000s +00.00100s
|`->config-rsyslog ran successfully @03.95100s +00.00100s
|`->config-users-groups ran successfully @03.95200s +00.09000s
|`->config-ssh ran successfully @04.04200s +00.35700s
Finished stage: (init-network) 01.43400 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @56.30300s +00.00000s
|`->config-snap ran successfully @56.30300s +00.00100s
|`->config-snap_config ran successfully @56.30400s +00.00100s
|`->config-ssh-import-id ran successfully @56.30500s +00.84400s
|`->config-locale ran successfully @57.15000s +00.00100s
|`->config-set-passwords ran successfully @57.15100s +00.00100s
|`->config-grub-dpkg ran successfully @57.15200s +00.26700s
|`->config-apt-pipelining ran successfully @57.41900s +00.00100s
|`->config-apt-configure ran successfully @57.42000s +00.12000s
|`->config-ubuntu-advantage ran successfully @57.54000s +00.00000s
|`->config-ntp ran successfully @57.54100s +00.08700s
|`->config-timezone ran successfully @57.63000s +00.00100s
|`->config-disable-ec2-metadata ran successfully @57.63100s +00.00000s
|`->config-runcmd ran successfully @57.63200s +00.00000s
|`->config-byobu ran successfully @57.63200s +00.00300s
Finished stage: (modules-config) 01.36000 seconds

Starting stage: modules-final
|`->config-snappy ran successfully @58.13600s +00.00200s
|`->config-package-update-upgrade-install ran successfully @58.13800s +00.00000s
|`->config-fan ran successfully @58.13900s +00.00000s
|`->config-landscape ran successfully @58.13900s +00.00100s
|`->config-lxd ran successfully @58.14000s +00.00100s
|`->config-ubuntu-drivers ran successfully @58.14100s +00.00000s
|`->config-puppet ran successfully @58.14200s +00.00000s
|`->config-chef ran successfully @58.14200s +00.00100s
|`->config-mcollective ran successfully @58.14300s +00.00100s
|`->config-salt-minion ran successfully @58.14400s +00.00000s
|`->config-rightscale_userdata ran successfully @58.14400s +00.00100s
|`->config-scripts-vendor ran successfully @58.14500s +00.00100s
|`->config-scripts-per-once ran successfully @58.14600s +00.00000s
|`->config-scripts-per-boot ran successfully @58.14700s +00.00000s
|`->config-scripts-per-instance ran successfully @58.14700s +00.00000s
|`->config-scripts-user ran successfully @58.14800s +00.00000s
|`->config-ssh-authkey-fingerprints ran successfully @58.14800s +00.00300s
|`->config-keys-to-console ran successfully @58.15100s +00.02500s
|`->config-phone-home ran successfully @58.17700s +00.00100s
|`->config-final-message ran successfully @58.17800s +00.00500s
|`->config-power-state-change ran successfully @58.18300s +00.00100s
Finished stage: (modules-final) 00.08000 seconds

Total Time: 3.07000 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.84400s (modules-config/config-ssh-import-id)
     00.43200s (init-network/config-growpart)
     00.35700s (init-network/config-ssh)
     00.26700s (modules-config/config-grub-dpkg)
     00.20700s (init-network/config-resizefs)
     00.12000s (modules-config/config-apt-configure)
     00.09000s (init-network/config-users-groups)
     00.08700s (modules-config/config-ntp)
     00.06800s (init-network/search-GCE)
     00.02500s (modules-final/config-keys-to-console)
     00.00700s (init-network/consume-user-data)
     00.00500s (modules-final/config-final-message)
     00.00500s (init-network/config-set_hostname)
     00.00300s (modules-final/config-ssh-authkey-fingerprints)
     00.00300s (modules-config/config-byobu)
     00.00200s (modules-final/config-snappy)
     00.00200s (init-network/config-mounts)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-write-files)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-disk_setup)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-network/activate-datasource)
     00.00100s (init-local/check-cache)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-user)
     00.00000s (modules-final/config-scripts-per-once)
     00.00000s (modules-final/config-scripts-per-instance)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-package-update-upgrade-install)
     00.00000s (modules-final/config-fan)
     00.00000s (modules-config/config-ubuntu-advantage)
     00.00000s (modules-config/config-runcmd)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/setup-datasource)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-network/check-cache)

1 boot records analyzed
Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:51
            set-name: ens4
    version: 2
setup_proposed.sh                                                                                                                                                                100%  194     4.1KB/s   00:00    
cloud-init is already the newest version (19.3-41-gc4735dd3-0ubuntu1~19.04.1).
cloud-init	19.3-41-gc4735dd3-0ubuntu1~19.04.1
Connection to 35.238.11.239 closed by remote host.
mkstemp: No such file or directory
ssh: connect to host 35.238.11.239 port 22: Connection refused
........
status: done
time: Mon, 20 Jan 2020 20:10:43 +0000
detail:
DataSourceGCE
SRU-worked-gce
Startup finished in 1.102s (kernel) + 18.002s (userspace) = 19.104s 
graphical.target reached after 15.026s in userspace
          5.394s snap.lxd.activate.service
          3.617s snapd.service
          3.575s cloud-config.service
          2.809s google-instance-setup.service
          2.666s systemd-logind.service
          2.539s systemd-hostnamed.service
          1.986s pollinate.service
          1.753s systemd-networkd-wait-online.service
          1.600s dev-sda1.device
          1.544s lvm2-monitor.service
          1.480s networkd-dispatcher.service
          1.348s cloud-init-local.service
          1.268s cloud-init.service
          1.247s systemd-udev-settle.service
           879ms apparmor.service
           619ms systemd-journald.service
           547ms cloud-final.service
           410ms rsyslog.service
           389ms accounts-daemon.service
           365ms grub-common.service
           353ms systemd-resolved.service
           345ms systemd-networkd.service
           328ms user@1000.service
           306ms google-startup-scripts.service
           281ms systemd-journal-flush.service
           278ms apport.service
           250ms atd.service
           233ms plymouth-quit.service
           220ms plymouth-quit-wait.service
           218ms snapd.seeded.service
           212ms keyboard-setup.service
           211ms kmod-static-nodes.service
           211ms systemd-modules-load.service
           210ms systemd-udev-trigger.service
           190ms snapd.socket
           170ms systemd-user-sessions.service
           129ms setvtrgb.service
           124ms dev-loop1.device
           106ms blk-availability.service
           105ms ssh.service
            97ms sys-kernel-debug.mount
            97ms dev-hugepages.mount
            96ms systemd-remount-fs.service
            95ms ufw.service
            94ms systemd-sysusers.service
            92ms dev-loop2.device
            88ms systemd-sysctl.service
            86ms sshguard.service
            82ms systemd-udevd.service
            69ms multipathd.service
            65ms chrony.service
            65ms grub-initrd-fallback.service
            59ms dev-mqueue.mount
            42ms systemd-tmpfiles-setup.service
            42ms snap-core-8268.mount
            42ms sys-fs-fuse-connections.mount
            41ms finalrd.service
            40ms snap-lxd-12631.mount
            39ms snap-google\x2dcloud\x2dsdk-113.mount
            38ms console-setup.service
            35ms dev-loop0.device
            34ms sys-kernel-config.mount
            34ms plymouth-read-write.service
            33ms user-runtime-dir@1000.service
            33ms boot-efi.mount
            30ms systemd-random-seed.service
            27ms systemd-tmpfiles-setup-dev.service
            25ms google-shutdown-scripts.service
            12ms systemd-update-utmp.service
            11ms systemd-update-utmp-runlevel.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00000s
Finished stage: (init-local) 00.17000 seconds

Starting stage: init-network
|`->no cache found @02.76400s +00.00000s
|`->found network data from DataSourceGCE @02.76800s +00.04600s
|`->setting up datasource @02.97300s +00.00000s
|`->reading and applying user-data @02.98600s +00.00700s
|`->reading and applying vendor-data @02.99300s +00.00000s
|`->activating datasource @03.01800s +00.00200s
|`->config-migrator ran successfully @03.04500s +00.00100s
|`->config-seed_random ran successfully @03.04600s +00.00300s
|`->config-bootcmd ran successfully @03.04900s +00.00000s
|`->config-write-files ran successfully @03.05000s +00.00000s
|`->config-growpart ran successfully @03.05000s +00.08100s
|`->config-resizefs ran successfully @03.13200s +00.07000s
|`->config-disk_setup ran successfully @03.20300s +00.00100s
|`->config-mounts ran successfully @03.20400s +00.00100s
|`->config-set_hostname ran successfully @03.20500s +00.00800s
|`->config-update_hostname ran successfully @03.21400s +00.00100s
|`->config-update_etc_hosts ran successfully @03.21500s +00.00000s
|`->config-ca-certs ran successfully @03.21600s +00.00000s
|`->config-rsyslog ran successfully @03.21600s +00.00100s
|`->config-users-groups ran successfully @03.21700s +00.06600s
|`->config-ssh ran successfully @03.28400s +00.30800s
Finished stage: (init-network) 00.84500 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @11.52100s +00.00000s
|`->config-snap ran successfully @11.52100s +00.00100s
|`->config-snap_config ran successfully @11.52200s +00.00100s
|`->config-ssh-import-id ran successfully @11.52300s +01.08400s
|`->config-locale ran successfully @12.60800s +00.00100s
|`->config-set-passwords ran successfully @12.60900s +00.00100s
|`->config-grub-dpkg ran successfully @12.61000s +00.34100s
|`->config-apt-pipelining ran successfully @12.95100s +00.00100s
|`->config-apt-configure ran successfully @12.95200s +00.17100s
|`->config-ubuntu-advantage ran successfully @13.12300s +00.00100s
|`->config-ntp ran successfully @13.12400s +00.08600s
|`->config-timezone ran successfully @13.21200s +00.00100s
|`->config-disable-ec2-metadata ran successfully @13.21300s +00.00000s
|`->config-runcmd ran successfully @13.21300s +00.00100s
|`->config-byobu ran successfully @13.21400s +00.00100s
Finished stage: (modules-config) 01.72300 seconds

Starting stage: modules-final
|`->config-snappy ran successfully @13.72200s +00.00200s
|`->config-package-update-upgrade-install ran successfully @13.72400s +00.00100s
|`->config-fan ran successfully @13.72500s +00.00000s
|`->config-landscape ran successfully @13.72600s +00.00000s
|`->config-lxd ran successfully @13.72600s +00.00100s
|`->config-ubuntu-drivers ran successfully @13.72700s +00.00000s
|`->config-puppet ran successfully @13.72800s +00.00000s
|`->config-chef ran successfully @13.72800s +00.00100s
|`->config-mcollective ran successfully @13.72900s +00.00100s
|`->config-salt-minion ran successfully @13.73000s +00.00000s
|`->config-rightscale_userdata ran successfully @13.73000s +00.00100s
|`->config-scripts-vendor ran successfully @13.73100s +00.00100s
|`->config-scripts-per-once ran successfully @13.73200s +00.00000s
|`->config-scripts-per-boot ran successfully @13.73200s +00.00100s
|`->config-scripts-per-instance ran successfully @13.73300s +00.00000s
|`->config-scripts-user ran successfully @13.73400s +00.00000s
|`->config-ssh-authkey-fingerprints ran successfully @13.73400s +00.00300s
|`->config-keys-to-console ran successfully @13.73700s +00.02400s
|`->config-phone-home ran successfully @13.76200s +00.00100s
|`->config-final-message ran successfully @13.76300s +00.00400s
|`->config-power-state-change ran successfully @13.76800s +00.00000s
Finished stage: (modules-final) 00.07900 seconds

Total Time: 2.81700 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.08400s (modules-config/config-ssh-import-id)
     00.34100s (modules-config/config-grub-dpkg)
     00.30800s (init-network/config-ssh)
     00.17100s (modules-config/config-apt-configure)
     00.08600s (modules-config/config-ntp)
     00.08100s (init-network/config-growpart)
     00.07000s (init-network/config-resizefs)
     00.06600s (init-network/config-users-groups)
     00.04600s (init-network/search-GCE)
     00.02400s (modules-final/config-keys-to-console)
     00.00800s (init-network/config-set_hostname)
     00.00700s (init-network/consume-user-data)
     00.00400s (modules-final/config-final-message)
     00.00300s (modules-final/config-ssh-authkey-fingerprints)
     00.00300s (init-network/config-seed_random)
     00.00200s (modules-final/config-snappy)
     00.00200s (init-network/activate-datasource)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-runcmd)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-byobu)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-migrator)
     00.00100s (init-network/config-disk_setup)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-user)
     00.00000s (modules-final/config-scripts-per-once)
     00.00000s (modules-final/config-scripts-per-instance)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-power-state-change)
     00.00000s (modules-final/config-landscape)
     00.00000s (modules-final/config-fan)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (modules-config/config-disable-ec2-metadata)
     00.00000s (init-network/setup-datasource)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-ca-certs)
     00.00000s (init-network/config-bootcmd)
     00.00000s (init-network/check-cache)
     00.00000s (init-local/check-cache)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:51
            set-name: ens4
    version: 2
cloud-region: gce-us-central1
Get cloud-id
gce
Validating whether metadata is being updated per boot LP:1819913
2020-01-20 20:10:32,464 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
ssh: connect to host 35.238.11.239 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:11:19 +0000
detail:
DataSourceGCE
After reboot
2020-01-20 20:10:32,464 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2020-01-20 20:11:11,544 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
### BEGIN eoan
Created [https://www.googleapis.com/compute/v1/projects/ubuntu-oddbloke/zones/us-central1-b/instances/eoan-sru-test].
NAME           ZONE           MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS
eoan-sru-test  us-central1-b  n1-standard-1               10.240.0.82  35.225.142.85  RUNNING

status: done
time: Mon, 20 Jan 2020 20:34:39 +0000
detail:
DataSourceGCE
cloud-init	19.3-41-gc4735dd3-0ubuntu1~19.10.1
{
 "v1": {
  "datasource": "DataSourceGCE",
  "errors": []
 }
}
Startup finished in 1.085s (kernel) + 52.936s (userspace) = 54.021s
graphical.target reached after 50.151s in userspace
         38.882s snapd.seeded.service
         11.065s pollinate.service
          1.950s systemd-networkd-wait-online.service
          1.911s cloud-config.service
          1.754s cloud-init.service
          1.645s systemd-logind.service
          1.470s google-instance-setup.service
          1.441s accounts-daemon.service
          1.372s lvm2-monitor.service
          1.328s dev-sda1.device
          1.287s cloud-init-local.service
          1.185s networkd-dispatcher.service
          1.165s systemd-udev-settle.service
          1.047s snapd.service
           867ms polkit.service
           746ms apparmor.service
           555ms cloud-final.service
           537ms systemd-journald.service
           403ms snap.lxd.activate.service
           371ms apport.service
           351ms systemd-udev-trigger.service
           342ms rsyslog.service
           339ms systemd-resolved.service
           333ms systemd-networkd.service
           321ms grub-common.service
           314ms snapd.socket
           306ms google-startup-scripts.service
           280ms plymouth-quit-wait.service
           274ms plymouth-quit.service
           246ms ufw.service
           237ms keyboard-setup.service
           211ms grub-initrd-fallback.service
           194ms systemd-user-sessions.service
           191ms dev-mqueue.mount
           190ms atd.service
           170ms systemd-modules-load.service
           163ms sys-kernel-debug.mount
           126ms user@1000.service
           112ms systemd-remount-fs.service
           100ms systemd-sysusers.service
            97ms sys-kernel-config.mount
            96ms systemd-sysctl.service
            88ms dev-hugepages.mount
            86ms blk-availability.service
            82ms systemd-udevd.service
            67ms chrony.service
            63ms multipathd.service
            59ms systemd-random-seed.service
            58ms dev-loop2.device
            52ms kmod-static-nodes.service
            51ms sys-fs-fuse-connections.mount
            47ms console-setup.service
            46ms systemd-machine-id-commit.service
            45ms plymouth-read-write.service
            43ms systemd-tmpfiles-setup.service
            41ms finalrd.service
            38ms ssh.service
            33ms setvtrgb.service
            31ms snap-google\x2dcloud\x2dsdk-113.mount
            30ms snap-lxd-12631.mount
            27ms systemd-journal-flush.service
            27ms snap-core-8268.mount
            27ms systemd-tmpfiles-setup-dev.service
            21ms user-runtime-dir@1000.service
            20ms dev-loop1.device
            19ms systemd-update-utmp-runlevel.service
            19ms google-shutdown-scripts.service
            19ms dev-loop0.device
            17ms boot-efi.mount
            11ms systemd-update-utmp.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00100s
Finished stage: (init-local) 00.17900 seconds

Starting stage: init-network
|`->no cache found @02.96500s +00.00100s
|`->found network data from DataSourceGCE @02.96900s +00.07000s
|`->setting up datasource @03.19100s +00.00100s
|`->reading and applying user-data @03.20500s +00.00800s
|`->reading and applying vendor-data @03.21400s +00.00000s
|`->activating datasource @03.26300s +00.00100s
|`->config-migrator ran successfully @03.29000s +00.00000s
|`->config-seed_random ran successfully @03.29000s +00.00100s
|`->config-bootcmd ran successfully @03.29100s +00.00100s
|`->config-write-files ran successfully @03.29200s +00.00000s
|`->config-growpart ran successfully @03.29300s +00.43600s
|`->config-resizefs ran successfully @03.72900s +00.15600s
|`->config-disk_setup ran successfully @03.88500s +00.00100s
|`->config-mounts ran successfully @03.88700s +00.00100s
|`->config-set_hostname ran successfully @03.88800s +00.00500s
|`->config-update_hostname ran successfully @03.89300s +00.00100s
|`->config-update_etc_hosts ran successfully @03.89400s +00.00100s
|`->config-ca-certs ran successfully @03.89500s +00.00000s
|`->config-rsyslog ran successfully @03.89600s +00.00000s
|`->config-users-groups ran successfully @03.89600s +00.06600s
|`->config-ssh ran successfully @03.96200s +00.30300s
Finished stage: (init-network) 01.31900 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @46.70700s +00.00000s
|`->config-snap ran successfully @46.70700s +00.00100s
|`->config-snap_config ran successfully @46.70800s +00.00100s
|`->config-ssh-import-id ran successfully @46.70900s +00.88700s
|`->config-locale ran successfully @47.59700s +00.00200s
|`->config-set-passwords ran successfully @47.59900s +00.00000s
|`->config-grub-dpkg ran successfully @47.60000s +00.25400s
|`->config-apt-pipelining ran successfully @47.85500s +00.00100s
|`->config-apt-configure ran successfully @47.85600s +00.08700s
|`->config-ubuntu-advantage ran successfully @47.94300s +00.00100s
|`->config-ntp ran successfully @47.94400s +00.10600s
|`->config-timezone ran successfully @48.05400s +00.00200s
|`->config-disable-ec2-metadata ran successfully @48.05600s +00.00100s
|`->config-runcmd ran successfully @48.05700s +00.00000s
|`->config-byobu ran successfully @48.05800s +00.00000s
Finished stage: (modules-config) 01.37600 seconds

Starting stage: modules-final
|`->config-snappy ran successfully @48.57900s +00.00200s
|`->config-package-update-upgrade-install ran successfully @48.58100s +00.00100s
|`->config-fan ran successfully @48.58200s +00.00000s
|`->config-landscape ran successfully @48.58200s +00.00100s
|`->config-lxd ran successfully @48.58300s +00.00100s
|`->config-ubuntu-drivers ran successfully @48.58400s +00.00000s
|`->config-puppet ran successfully @48.58500s +00.00000s
|`->config-chef ran successfully @48.58500s +00.00100s
|`->config-mcollective ran successfully @48.58600s +00.00100s
|`->config-salt-minion ran successfully @48.58700s +00.00000s
|`->config-rightscale_userdata ran successfully @48.58700s +00.00100s
|`->config-scripts-vendor ran successfully @48.58800s +00.00100s
|`->config-scripts-per-once ran successfully @48.58900s +00.00000s
|`->config-scripts-per-boot ran successfully @48.58900s +00.00100s
|`->config-scripts-per-instance ran successfully @48.59000s +00.00000s
|`->config-scripts-user ran successfully @48.59000s +00.00100s
|`->config-ssh-authkey-fingerprints ran successfully @48.59100s +00.00200s
|`->config-keys-to-console ran successfully @48.59400s +00.02400s
|`->config-phone-home ran successfully @48.61900s +00.00100s
|`->config-final-message ran successfully @48.62000s +00.00400s
|`->config-power-state-change ran successfully @48.62400s +00.00100s
Finished stage: (modules-final) 00.07500 seconds

Total Time: 2.94900 seconds

1 boot records analyzed
-- Boot Record 01 --
     00.88700s (modules-config/config-ssh-import-id)
     00.43600s (init-network/config-growpart)
     00.30300s (init-network/config-ssh)
     00.25400s (modules-config/config-grub-dpkg)
     00.15600s (init-network/config-resizefs)
     00.10600s (modules-config/config-ntp)
     00.08700s (modules-config/config-apt-configure)
     00.07000s (init-network/search-GCE)
     00.06600s (init-network/config-users-groups)
     00.02400s (modules-final/config-keys-to-console)
     00.00800s (init-network/consume-user-data)
     00.00500s (init-network/config-set_hostname)
     00.00400s (modules-final/config-final-message)
     00.00200s (modules-final/config-ssh-authkey-fingerprints)
     00.00200s (modules-final/config-snappy)
     00.00200s (modules-config/config-timezone)
     00.00200s (modules-config/config-locale)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-user)
     00.00100s (modules-final/config-scripts-per-boot)
     00.00100s (modules-final/config-rightscale_userdata)
     00.00100s (modules-final/config-power-state-change)
     00.00100s (modules-final/config-phone-home)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-lxd)
     00.00100s (modules-final/config-landscape)
     00.00100s (modules-final/config-chef)
     00.00100s (modules-config/config-ubuntu-advantage)
     00.00100s (modules-config/config-snap_config)
     00.00100s (modules-config/config-snap)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/setup-datasource)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-update_etc_hosts)
     00.00100s (init-network/config-seed_random)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-disk_setup)
     00.00100s (init-network/config-bootcmd)
     00.00100s (init-network/check-cache)
     00.00100s (init-network/activate-datasource)
     00.00100s (init-local/check-cache)
     00.00000s (modules-final/config-ubuntu-drivers)
     00.00000s (modules-final/config-scripts-per-once)
     00.00000s (modules-final/config-scripts-per-instance)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-fan)
     00.00000s (modules-config/config-set-passwords)
     00.00000s (modules-config/config-runcmd)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (modules-config/config-byobu)
     00.00000s (init-network/consume-vendor-data)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-rsyslog)
     00.00000s (init-network/config-migrator)
     00.00000s (init-network/config-ca-certs)

1 boot records analyzed
Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:52
            set-name: ens4
    version: 2
setup_proposed.sh                                                                                                                                                                100%  194     4.0KB/s   00:00
  cloud-init
Get:1 http://archive.ubuntu.com/ubuntu eoan-proposed/main amd64 cloud-init all 19.4-33-gbb4131a2-0ubuntu1~19.10.1 [405 kB]
Preparing to unpack .../cloud-init_19.4-33-gbb4131a2-0ubuntu1~19.10.1_all.deb ...
Unpacking cloud-init (19.4-33-gbb4131a2-0ubuntu1~19.10.1) over (19.3-41-gc4735dd3-0ubuntu1~19.10.1) ...
Setting up cloud-init (19.4-33-gbb4131a2-0ubuntu1~19.10.1) ...
cloud-init	19.4-33-gbb4131a2-0ubuntu1~19.10.1
Connection to 35.225.142.85 closed by remote host.
mkstemp: No such file or directory
ssh: connect to host 35.225.142.85 port 22: Connection refused
ssh: connect to host 35.225.142.85 port 22: Connection refused

status: done
time: Mon, 20 Jan 2020 20:35:51 +0000
detail:
DataSourceGCE
SRU-worked-gce
Startup finished in 1.105s (kernel) + 18.995s (userspace) = 20.101s
graphical.target reached after 14.311s in userspace
          4.501s snap.lxd.activate.service
          3.531s snapd.service
          3.529s cloud-config.service
          2.632s systemd-hostnamed.service
          2.579s systemd-logind.service
          2.387s e2scrub_reap.service
          2.274s google-instance-setup.service
          2.178s pollinate.service
          2.172s accounts-daemon.service
          2.095s networkd-dispatcher.service
          1.922s systemd-networkd-wait-online.service
          1.662s cloud-init.service
          1.467s lvm2-monitor.service
          1.385s dev-sda1.device
          1.331s polkit.service
          1.330s cloud-init-local.service
          1.268s systemd-udev-settle.service
          1.138s cloud-final.service
           736ms rsyslog.service
           681ms blk-availability.service
           577ms google-startup-scripts.service
           502ms setvtrgb.service
           484ms systemd-journald.service
           423ms apparmor.service
           394ms grub-common.service
           360ms plymouth-quit-wait.service
           345ms systemd-resolved.service
           325ms systemd-networkd.service
           303ms grub-initrd-fallback.service
           302ms apport.service
           289ms systemd-journal-flush.service
           237ms keyboard-setup.service
           207ms systemd-udev-trigger.service
           178ms user@1000.service
           175ms ssh.service
           170ms systemd-user-sessions.service
           168ms snapd.socket
           128ms dev-mqueue.mount
           127ms ufw.service
           121ms plymouth-quit.service
           119ms atd.service
           119ms systemd-udevd.service
           114ms snapd.seeded.service
           112ms dev-hugepages.mount
           112ms sys-kernel-debug.mount
           111ms dev-loop0.device
           106ms dev-loop2.device
            99ms dev-loop1.device
            94ms systemd-remount-fs.service
            91ms systemd-sysusers.service
            79ms sys-kernel-config.mount
            70ms systemd-modules-load.service
            67ms chrony.service
            67ms snap-lxd-12631.mount
            67ms multipathd.service
            59ms sys-fs-fuse-connections.mount
            55ms systemd-sysctl.service
            55ms systemd-update-utmp-runlevel.service
            51ms snap-core-8268.mount
            51ms kmod-static-nodes.service
            47ms snap-google\x2dcloud\x2dsdk-113.mount
            44ms systemd-tmpfiles-setup.service
            36ms boot-efi.mount
            33ms google-shutdown-scripts.service
            28ms user-runtime-dir@1000.service
            26ms finalrd.service
            26ms console-setup.service
            25ms plymouth-read-write.service
            25ms systemd-tmpfiles-setup-dev.service
            19ms systemd-update-utmp.service
            13ms systemd-random-seed.service
-- Boot Record 01 --
The total time elapsed since completing an event is printed after the "@" character.
The time the event takes is printed after the "+" character.

Starting stage: init-local
|`->no cache found @00.00400s +00.00000s
Finished stage: (init-local) 00.17000 seconds

Starting stage: init-network
|`->no cache found @02.92500s +00.00000s
|`->found network data from DataSourceGCE @02.92900s +00.04800s
|`->setting up datasource @03.15200s +00.00100s
|`->reading and applying user-data @03.16500s +00.00800s
|`->reading and applying vendor-data @03.17300s +00.00100s
|`->activating datasource @03.21700s +00.00200s
|`->config-migrator ran successfully @03.36600s +00.00000s
|`->config-seed_random ran successfully @03.36700s +00.00000s
|`->config-bootcmd ran successfully @03.36700s +00.00100s
|`->config-write-files ran successfully @03.36800s +00.00000s
|`->config-growpart ran successfully @03.36800s +00.08300s
|`->config-resizefs ran successfully @03.45100s +00.05600s
|`->config-disk_setup ran successfully @03.50700s +00.00100s
|`->config-mounts ran successfully @03.50800s +00.00100s
|`->config-set_hostname ran successfully @03.51000s +00.00500s
|`->config-update_hostname ran successfully @03.51600s +00.00100s
|`->config-update_etc_hosts ran successfully @03.51700s +00.00000s
|`->config-ca-certs ran successfully @03.51700s +00.00100s
|`->config-rsyslog ran successfully @03.51800s +00.00100s
|`->config-users-groups ran successfully @03.51900s +00.04000s
|`->config-ssh ran successfully @03.55900s +00.56400s
Finished stage: (init-network) 01.21500 seconds

Starting stage: modules-config
|`->config-emit_upstart ran successfully @10.99400s +00.00000s
|`->config-snap ran successfully @10.99500s +00.00000s
|`->config-ssh-import-id ran successfully @10.99500s +01.44300s
|`->config-locale ran successfully @12.43900s +00.00100s
|`->config-set-passwords ran successfully @12.44000s +00.00100s
|`->config-grub-dpkg ran successfully @12.44100s +00.44600s
|`->config-apt-pipelining ran successfully @12.88800s +00.00100s
|`->config-apt-configure ran successfully @12.88900s +00.08800s
|`->config-ubuntu-advantage ran successfully @12.97700s +00.00000s
|`->config-ntp ran successfully @12.97800s +00.08900s
|`->config-timezone ran successfully @13.06900s +00.00100s
|`->config-disable-ec2-metadata ran successfully @13.07000s +00.00100s
|`->config-runcmd ran successfully @13.07100s +00.00200s
|`->config-byobu ran successfully @13.07300s +00.00000s
Finished stage: (modules-config) 02.13600 seconds

Starting stage: modules-final
|`->config-package-update-upgrade-install ran successfully @14.07100s +00.00100s
|`->config-fan ran successfully @14.07200s +00.00100s
|`->config-landscape ran successfully @14.07300s +00.00000s
|`->config-lxd ran successfully @14.07400s +00.00000s
|`->config-ubuntu-drivers ran successfully @14.07400s +00.00100s
|`->config-puppet ran successfully @14.07500s +00.00000s
|`->config-chef ran successfully @14.07600s +00.00000s
|`->config-mcollective ran successfully @14.07600s +00.00100s
|`->config-salt-minion ran successfully @14.07700s +00.00000s
|`->config-rightscale_userdata ran successfully @14.07800s +00.00000s
|`->config-scripts-vendor ran successfully @14.07800s +00.00100s
|`->config-scripts-per-once ran successfully @14.07900s +00.00100s
|`->config-scripts-per-boot ran successfully @14.08000s +00.00000s
|`->config-scripts-per-instance ran successfully @14.08000s +00.00100s
|`->config-scripts-user ran successfully @14.08100s +00.00000s
|`->config-ssh-authkey-fingerprints ran successfully @14.08100s +00.00300s
|`->config-keys-to-console ran successfully @14.08400s +00.03400s
|`->config-phone-home ran successfully @14.11800s +00.00200s
|`->config-final-message ran successfully @14.12000s +00.00800s
|`->config-power-state-change ran successfully @14.12900s +00.00400s
Finished stage: (modules-final) 00.10000 seconds

Total Time: 3.62100 seconds

1 boot records analyzed
-- Boot Record 01 --
     01.44300s (modules-config/config-ssh-import-id)
     00.56400s (init-network/config-ssh)
     00.44600s (modules-config/config-grub-dpkg)
     00.08900s (modules-config/config-ntp)
     00.08800s (modules-config/config-apt-configure)
     00.08300s (init-network/config-growpart)
     00.05600s (init-network/config-resizefs)
     00.04800s (init-network/search-GCE)
     00.04000s (init-network/config-users-groups)
     00.03400s (modules-final/config-keys-to-console)
     00.00800s (modules-final/config-final-message)
     00.00800s (init-network/consume-user-data)
     00.00500s (init-network/config-set_hostname)
     00.00400s (modules-final/config-power-state-change)
     00.00300s (modules-final/config-ssh-authkey-fingerprints)
     00.00200s (modules-final/config-phone-home)
     00.00200s (modules-config/config-runcmd)
     00.00200s (init-network/activate-datasource)
     00.00100s (modules-final/config-ubuntu-drivers)
     00.00100s (modules-final/config-scripts-vendor)
     00.00100s (modules-final/config-scripts-per-once)
     00.00100s (modules-final/config-scripts-per-instance)
     00.00100s (modules-final/config-package-update-upgrade-install)
     00.00100s (modules-final/config-mcollective)
     00.00100s (modules-final/config-fan)
     00.00100s (modules-config/config-timezone)
     00.00100s (modules-config/config-set-passwords)
     00.00100s (modules-config/config-locale)
     00.00100s (modules-config/config-disable-ec2-metadata)
     00.00100s (modules-config/config-apt-pipelining)
     00.00100s (init-network/setup-datasource)
     00.00100s (init-network/consume-vendor-data)
     00.00100s (init-network/config-update_hostname)
     00.00100s (init-network/config-rsyslog)
     00.00100s (init-network/config-mounts)
     00.00100s (init-network/config-disk_setup)
     00.00100s (init-network/config-ca-certs)
     00.00100s (init-network/config-bootcmd)
     00.00000s (modules-final/config-scripts-user)
     00.00000s (modules-final/config-scripts-per-boot)
     00.00000s (modules-final/config-salt-minion)
     00.00000s (modules-final/config-rightscale_userdata)
     00.00000s (modules-final/config-puppet)
     00.00000s (modules-final/config-lxd)
     00.00000s (modules-final/config-landscape)
     00.00000s (modules-final/config-chef)
     00.00000s (modules-config/config-ubuntu-advantage)
     00.00000s (modules-config/config-snap)
     00.00000s (modules-config/config-emit_upstart)
     00.00000s (modules-config/config-byobu)
     00.00000s (init-network/config-write-files)
     00.00000s (init-network/config-update_etc_hosts)
     00.00000s (init-network/config-seed_random)
     00.00000s (init-network/config-migrator)
     00.00000s (init-network/check-cache)
     00.00000s (init-local/check-cache)

1 boot records analyzed
After upgrade Networking config
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        ens4:
            dhcp4: true
            match:
                macaddress: 42:01:0a:f0:00:52
            set-name: ens4
    version: 2
cloud-region: gce-us-central1
Get cloud-id
gce
Validating whether metadata is being updated per boot LP:1819913
2020-01-20 20:35:40,357 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
ssh: connect to host 35.225.142.85 port 22: Connection refused
..
status: done
time: Mon, 20 Jan 2020 20:36:25 +0000
detail:
DataSourceGCE
After reboot
2020-01-20 20:35:40,357 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
2020-01-20 20:36:16,483 - __init__.py[DEBUG]: Update datasource metadata and network config due to events: New instance first boot
