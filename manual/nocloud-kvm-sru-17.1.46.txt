
###  Verification script

Here's the script we run on torkoal to get nocloud-kvm tests for xenial, zesty and artful --proposed cloud-init


#!/bin/bash
## test proposed by pulling the source from the package
## and then running integration test for platform.
start_d="$PWD"
platform="nocloud-kvm"
for rel in "$@"; do
   cd "$start_d"
   out_d="$PWD/$rel-$platform-results.d"
   log="$PWD/$rel-$platform.log"
   [ ! -e "$out_d" ] || { echo "skipping existing $out_d"; continue; }
   rm -Rf work.d
   mkdir work.d || { echo "failed to make work.d in $start_d"; exit 1; }
   (
   set -e
   start_s=$SECONDS
   cd work.d
   pull-lp-source cloud-init "$rel-proposed"
   cd cloud-init-*
   echo "testing in ${PWD##*/}"
   proposed="deb http://archive.ubuntu.com/ubuntu/ $rel-proposed main"
   tox -e citest -- run --verbose \
       --preserve-data \
       "--data-dir=$out_d" \
       "--platform=$platform" \
       --os-name=$rel \
       "--repo=$proposed" 
   r=$?
   echo "exited with $r in $((SECONDS-${start_s}))"
   exit $r
   ) 2>&1 | tee $log
done





### SRU verification output for 17.1.46 for nocloud-kvm integration tests
<smoser's verification run>

